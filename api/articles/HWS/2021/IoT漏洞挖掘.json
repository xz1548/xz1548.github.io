{"title":"IoT漏洞挖掘","uid":"4946ce3f910e8961231b36c71843c41e","slug":"HWS/2021/IoT漏洞挖掘","date":"2022-02-04T02:13:10.000Z","updated":"2022-02-05T04:02:54.445Z","comments":true,"path":"api/articles/HWS/2021/IoT漏洞挖掘.json","keywords":null,"cover":"/img/33.png","content":"<span id=\"more\"></span>\n\n<h1 id=\"IoT固件安全之漏洞挖掘\"><a href=\"#IoT固件安全之漏洞挖掘\" class=\"headerlink\" title=\"IoT固件安全之漏洞挖掘\"></a>IoT固件安全之漏洞挖掘</h1><h2 id=\"常用组件中的漏洞品发点\"><a href=\"#常用组件中的漏洞品发点\" class=\"headerlink\" title=\"常用组件中的漏洞品发点\"></a>常用组件中的漏洞品发点</h2><h3 id=\"web管理服务\"><a href=\"#web管理服务\" class=\"headerlink\" title=\"web管理服务\"></a>web管理服务</h3><h4 id=\"uhttpd\"><a href=\"#uhttpd\" class=\"headerlink\" title=\"uhttpd\"></a>uhttpd</h4><p>最常用的服务</p>\n<ul>\n<li>历史漏洞：<strong>CVE-2019-19945</strong>、CVE-2018-19630</li>\n<li>主流组件漏洞：LuCI（CVE-2019-17367、<strong>CVE-2019-12272</strong>）、UCI（CVE-2020-28951）</li>\n<li>二次开发过程中漏洞频发点：审计CGI、Lua、PHP</li>\n</ul>\n<h4 id=\"thttpd-minihttpd\"><a href=\"#thttpd-minihttpd\" class=\"headerlink\" title=\"thttpd/minihttpd\"></a>thttpd/minihttpd</h4><ul>\n<li>历史漏洞：</li>\n<li>二次开发过程中漏洞频发点：thttpd对header内容无检查</li>\n</ul>\n<h4 id=\"lighttpd\"><a href=\"#lighttpd\" class=\"headerlink\" title=\"lighttpd\"></a>lighttpd</h4><ul>\n<li>历史漏洞：CVE-2018-18878、CVE-2015-1548</li>\n<li>二次开发过程中漏洞频发点：</li>\n</ul>\n<h4 id=\"GoAhead\"><a href=\"#GoAhead\" class=\"headerlink\" title=\"GoAhead\"></a>GoAhead</h4><ul>\n<li>历史漏洞：CVE-2019-5096、<strong>CVE-2017-17562</strong></li>\n<li>二次开发过程中漏洞：goform Handler、asp Handler、security Handler、</li>\n</ul>\n<h4 id=\"厂商自研\"><a href=\"#厂商自研\" class=\"headerlink\" title=\"厂商自研\"></a>厂商自研</h4><ul>\n<li>MoxaHttp</li>\n<li>ZTE Mini Web</li>\n</ul>\n<h3 id=\"常用组件的漏洞频发点\"><a href=\"#常用组件的漏洞频发点\" class=\"headerlink\" title=\"常用组件的漏洞频发点\"></a>常用组件的漏洞频发点</h3><h4 id=\"UPNP服务\"><a href=\"#UPNP服务\" class=\"headerlink\" title=\"UPNP服务\"></a>UPNP服务</h4><ul>\n<li>Miniupnp/MiniDLNA：CVE-2020-28926、CVE-2019-12106、CallStranger</li>\n<li>Libupnp：CVE-2020-13848、CVE-2016-8863</li>\n<li>各厂自研…</li>\n</ul>\n<h4 id=\"RTSP服务\"><a href=\"#RTSP服务\" class=\"headerlink\" title=\"RTSP服务\"></a>RTSP服务</h4><ul>\n<li>Live5555</li>\n<li>HiChipSDK</li>\n<li>各厂自研…</li>\n</ul>\n<h2 id=\"CVE-2020-14472-14473\"><a href=\"#CVE-2020-14472-14473\" class=\"headerlink\" title=\"CVE-2020-14472/14473\"></a>CVE-2020-14472/14473</h2><p>Step0：寻找合适的攻击面</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>Nmap扫描端口</li>\n<li>不考虑vpn相关端口（安全性较高）</li>\n<li>HTTPS与HTTP：存在lighttpd二次开发，因此重点关注</li>\n</ul></blockquote>\n<p>Step1：固件解包，上官网找固件</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>先binwalk分析、只有一个ubi、用ubireader提取</li>\n<li>提取后就是一个linux文件系统</li>\n<li>在/etc/init.d下的rcs和rc.d查看启动项</li>\n<li>查找web管理端（httpd）是否在默认启动项</li>\n<li>查看接口，在www/cgi-bin目录下，用ida直接分析</li>\n</ul></blockquote>\n<p>Step2：静态逆向分析</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>以web管理服务为目标</li>\n<li>Lighttpd与CGI</li>\n</ul></blockquote>\n<h2 id=\"WMCTF-camera\"><a href=\"#WMCTF-camera\" class=\"headerlink\" title=\"WMCTF camera\"></a>WMCTF camera</h2>","text":" IoT固件安全之漏洞挖掘常用组件中的漏洞品发点web管理服务uhttpd最常用的服务 历史漏洞：CVE-2019-19945、CVE-2018-19630 主流组件漏洞：LuCI（CVE-2019-17367、CVE-2019-12272）、UCI（CVE-2020-28951...","link":"","photos":[],"count_time":{"symbolsCount":894,"symbolsTime":"1 mins."},"categories":[{"name":"HWS/2021","slug":"HWS-2021","count":5,"path":"api/categories/HWS-2021.json"}],"tags":[{"name":"HWS","slug":"HWS","count":8,"path":"api/tags/HWS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#IoT%E5%9B%BA%E4%BB%B6%E5%AE%89%E5%85%A8%E4%B9%8B%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98\"><span class=\"toc-text\">IoT固件安全之漏洞挖掘</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%93%81%E5%8F%91%E7%82%B9\"><span class=\"toc-text\">常用组件中的漏洞品发点</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#web%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">web管理服务</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#uhttpd\"><span class=\"toc-text\">uhttpd</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#thttpd-minihttpd\"><span class=\"toc-text\">thttpd&#x2F;minihttpd</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#lighttpd\"><span class=\"toc-text\">lighttpd</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#GoAhead\"><span class=\"toc-text\">GoAhead</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%8E%82%E5%95%86%E8%87%AA%E7%A0%94\"><span class=\"toc-text\">厂商自研</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E7%9A%84%E6%BC%8F%E6%B4%9E%E9%A2%91%E5%8F%91%E7%82%B9\"><span class=\"toc-text\">常用组件的漏洞频发点</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#UPNP%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">UPNP服务</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#RTSP%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">RTSP服务</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CVE-2020-14472-14473\"><span class=\"toc-text\">CVE-2020-14472&#x2F;14473</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#WMCTF-camera\"><span class=\"toc-text\">WMCTF camera</span></a></li></ol></li></ol>","author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"PWN","uid":"5fc856885126d17b63352c1a2dc49ef9","slug":"HWS/2021/PWN","date":"2022-02-04T07:03:52.000Z","updated":"2022-02-04T07:37:21.565Z","comments":true,"path":"api/articles/HWS/2021/PWN.json","keywords":null,"cover":"/img/34.jpg","text":" PWN题目中直呼精彩的利用手法程序没有leak时的利用技巧 例题：Magic Gadget ret2csuret2libsyscallpartial overwrite覆盖低位字节，达到不需要leak也可以修改目标值，可能存在一定爆破 通过House of Husk 入门IO_...","link":"","photos":[],"count_time":{"symbolsCount":557,"symbolsTime":"1 mins."},"categories":[{"name":"HWS/2021","slug":"HWS-2021","count":5,"path":"api/categories/HWS-2021.json"}],"tags":[{"name":"HWS","slug":"HWS","count":8,"path":"api/tags/HWS.json"}],"author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"物联网渗透","uid":"c9203e32c2797e4aca5216137b90ff82","slug":"HWS/2021/物联网渗透","date":"2022-02-04T01:05:46.000Z","updated":"2022-02-04T02:13:42.642Z","comments":true,"path":"api/articles/HWS/2021/物联网渗透.json","keywords":null,"cover":"/img/32.jpg","text":" 物联网渗透物联网设备安全概述物联网设备层次模型 物理感知层（固件提取、硬件攻击） 通信层（流量监听、中间人攻击） 管理控制层/应用层（web、rtsp、ssh…） 物联网设备通信模型云端，设备，移动端相互进行通信，三者各面临风险 云端安全风险 客户端（APP）安全风险 设备自身...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"HWS/2021","slug":"HWS-2021","count":5,"path":"api/categories/HWS-2021.json"}],"tags":[{"name":"HWS","slug":"HWS","count":8,"path":"api/tags/HWS.json"}],"author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}