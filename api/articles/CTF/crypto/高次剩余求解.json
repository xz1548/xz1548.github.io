{"title":"高次剩余求解","uid":"0f98a03e2be0fa66aad63599b5ae90ad","slug":"CTF/crypto/高次剩余求解","date":"2022-01-23T10:05:35.000Z","updated":"2022-01-23T12:33:27.135Z","comments":true,"path":"api/articles/CTF/crypto/高次剩余求解.json","keywords":null,"cover":"/img/28.jpg","content":"<span id=\"more\"></span>\n\n<h1 id=\"高次剩余求解\"><a href=\"#高次剩余求解\" class=\"headerlink\" title=\"高次剩余求解\"></a>高次剩余求解</h1><p>最近遇到了一个新的高次剩余求解的题目，学到了一个叫AMM的算法来求解，记录一下，顺便回头有空了补一下二次剩余的(挖坑ing)，已经忘了差不多了</p>\n<p>推导过程懒得看了，直接贴上论文的求解过程</p>\n<p><img src=\"/img/%E9%AB%98%E6%AC%A1%E5%89%A9%E4%BD%99%E6%B1%82%E8%A7%A3_img/image-20220123202932130.png\" alt=\"image-20220123202932130\"></p>\n<p>然后求解代码如下(代码来自智慧与美貌并存的好哥哥曲映曦师傅)，其中x是<mjx-container class=\"MathJax\" jax=\"SVG\"><svg style=\"vertical-align: -0.023ex\" xmlns=\"http://www.w3.org/2000/svg\" width=\"1.005ex\" height=\"1.645ex\" role=\"img\" focusable=\"false\" viewBox=\"0 -717 444 727\"><g stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" transform=\"scale(1,-1)\"><g data-mml-node=\"math\"><g data-mml-node=\"mi\"><path data-c=\"1D6FF\" d=\"M195 609Q195 656 227 686T302 717Q319 716 351 709T407 697T433 690Q451 682 451 662Q451 644 438 628T403 612Q382 612 348 641T288 671T249 657T235 628Q235 584 334 463Q401 379 401 292Q401 169 340 80T205 -10H198Q127 -10 83 36T36 153Q36 286 151 382Q191 413 252 434Q252 435 245 449T230 481T214 521T201 566T195 609ZM112 130Q112 83 136 55T204 27Q233 27 256 51T291 111T309 178T316 232Q316 267 309 298T295 344T269 400L259 396Q215 381 183 342T137 256T118 179T112 130Z\"></path></g></g></g></svg></mjx-container>，e是r，p是q</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">import</span> libnum\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> bytes_to_long<span class=\"token punctuation\">,</span>long_to_bytes\np <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">GF</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> p\n    p <span class=\"token operator\">=</span> a\n<span class=\"token keyword\">def</span> <span class=\"token function\">g</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> p\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">AMM</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span>\n    y <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">while</span> g<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">//</span>e<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n        y <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"find\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#p-1 = e^t*s</span>\n    t <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    s <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">while</span> p <span class=\"token operator\">%</span> e <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n        t <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span>\n    s <span class=\"token operator\">=</span> p <span class=\"token operator\">//</span> <span class=\"token punctuation\">(</span>e<span class=\"token operator\">**</span>t<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print('e',e)</span>\n    <span class=\"token comment\"># print('p',p)</span>\n    <span class=\"token comment\"># print('s',s)</span>\n    <span class=\"token comment\"># print('t',t)</span>\n    <span class=\"token comment\"># s|ralpha-1</span>\n    k <span class=\"token operator\">=</span> <span class=\"token number\">1</span>    \n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span> k <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> e <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        k <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    alpha <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span> k <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> e\n   \n    a <span class=\"token operator\">=</span> g<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>e <span class=\"token operator\">**</span> <span class=\"token punctuation\">(</span>t <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> s<span class=\"token punctuation\">)</span>\n    b <span class=\"token operator\">=</span> g<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> e <span class=\"token operator\">*</span> alpha <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    c <span class=\"token operator\">=</span> g<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span>\n    h <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    <span class=\"token comment\">#</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> t<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cur_i'</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span>\n        d <span class=\"token operator\">=</span> g<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span>e<span class=\"token operator\">**</span><span class=\"token punctuation\">(</span>t<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> d <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            j <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            j <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>math<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> e<span class=\"token punctuation\">)</span>\n        b <span class=\"token operator\">=</span> b <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        h <span class=\"token operator\">=</span> h <span class=\"token operator\">*</span> g<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span>\n        c <span class=\"token operator\">=</span> g<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>alpha <span class=\"token operator\">*</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> p<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n","feature":true,"text":" 高次剩余求解最近遇到了一个新的高次剩余求解的题目，学到了一个叫AMM的算法来求解，记录一下，顺便回头有空了补一下二次剩余的(挖坑ing)，已经忘了差不多了 推导过程懒得看了，直接贴上论文的求解过程 然后求解代码如下(代码来自智慧与美貌并存的好哥哥曲映曦师傅)，其中x是，e是r，...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"CTF/CRYPTO","slug":"CTF-CRYPTO","count":2,"path":"api/categories/CTF-CRYPTO.json"}],"tags":[{"name":"CTF CRYPTO","slug":"CTF-CRYPTO","count":2,"path":"api/tags/CTF-CRYPTO.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%AB%98%E6%AC%A1%E5%89%A9%E4%BD%99%E6%B1%82%E8%A7%A3\"><span class=\"toc-text\">高次剩余求解</span></a></li></ol>","author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"二进制","uid":"55fb07a4dbf6f44614d26c9d54b2e72f","slug":"HWS/2020/二进制","date":"2022-02-02T11:23:08.000Z","updated":"2022-02-02T11:29:00.075Z","comments":true,"path":"api/articles/HWS/2020/二进制.json","keywords":null,"cover":"/img/29.jpg","text":"写在前面HWS运气好打进了线下，就补习一下前两年的夏令营知识，刚好用来入门RE和PWN，本分类就用于记一些笔记 另外下面的逆向工程这一块没什么用全是misc入门知识，但是既然写了也懒得删，就留着吧 加密与解密流密码随机数预测爆破知道随机数产生的内容，预测次数比较少，精度比较低，可...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"HWS","slug":"HWS","count":1,"path":"api/categories/HWS.json"}],"tags":[{"name":"HWS 2020","slug":"HWS-2020","count":1,"path":"api/tags/HWS-2020.json"}],"author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Hexo主题数学公式渲染","uid":"6cbb80cb79ca010921d708bc73e8460f","slug":"blog/Hexo主题数学公式渲染","date":"2022-01-23T08:21:01.000Z","updated":"2022-01-23T08:26:03.675Z","comments":true,"path":"api/articles/blog/Hexo主题数学公式渲染.json","keywords":null,"cover":"/img/27.jpg","text":" Hexo主题数学公式渲染之前搭博客的时候内嵌数学公式一直没渲染出来，一大堆$$符号放着十分的呆，很多博客让卸了装好多包最后也没解决，这次放一下我的解决办法 首先hexo的框架应该都是支持mathjax的，只不过不同主题开启方式不同 首先需要安装majax插件 npm insta...","link":"","photos":[],"count_time":{"symbolsCount":214,"symbolsTime":"1 mins."},"categories":[{"name":"BLOG","slug":"BLOG","count":1,"path":"api/categories/BLOG.json"}],"tags":[{"name":"BLOG","slug":"BLOG","count":1,"path":"api/tags/BLOG.json"}],"author":{"name":"S1eepy","slug":"blog-author","avatar":"/img/touxiang.jpg","link":"/","description":"Someone who is learning how to take life seriously","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}